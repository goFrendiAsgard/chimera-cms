{"id":1,"branch":"true","vars":{"_verbose":0},"ins":"action, migrationConfig","out":"output","mode":"series","chains":[{"id":2,"branch":"action == 'up'","mode":"series","chains":[{"id":3,"branch":"true","ins":"'web_configs', 'find', {'key': 'navigation'}","out":"configList","command":"[$.helper.mongoExecute]","loop":"false"},{"id":4,"branch":"true","ins":"configList[0]","out":"config","command":"{$.assignValue}","loop":"false"},{"id":5,"branch":"true","ins":"config.value","out":"newValue","command":"{(oldValue) => {\n  let newValue = []\n  for (let navigation of oldValue) {\n    if (!navigation.groups || navigation.groups.length === 0) {\n      navigation.groups = ['loggedIn', 'loggedOut']\n      if (navigation.children) {\n        let oldChildren = navigation.children\n        let newChildren = []\n        for (let child of oldChildren) {\n          if (!('groups' in child) || child.groups.length === 0) {\n            child.groups = ['loggedIn', 'loggedOut']\n          }\n          newChildren.push(child)\n        }\n        navigation.children = newChildren\n      }\n    }\n    newValue.push(navigation)\n  }\n  return newValue\n}\n}","loop":"false"},{"id":6,"branch":"true","ins":"'web_configs', 'update', {'_id': config._id}, {'value': newValue}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"},{"id":7,"branch":"true","ins":"'web_routes', 'update', {'groups': {'$exists': false}}, {'groups': ['loggedIn', 'loggedOut']}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"},{"id":8,"branch":"true","ins":"'web_cck', 'update', {'selectGroups': {'$exists': false}}, {'selectGroups': ['loggedIn', 'loggedOut']}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"},{"id":9,"branch":"true","ins":"'web_cck', 'update', {'insertGroups': {'$exists': false}}, {'insertGroups': ['loggedIn', 'loggedOut']}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"},{"id":10,"branch":"true","ins":"'web_cck', 'update', {'updateGroups': {'$exists': false}}, {'updateGroups': ['loggedIn', 'loggedOut']}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"},{"id":11,"branch":"true","ins":"'web_cck', 'update', {'deleteGroups': {'$exists': false}}, {'deleteGroups': ['loggedIn', 'loggedOut']}, {'multi': 1}","out":"output","command":"[$.helper.mongoExecute]","loop":"false"}],"loop":"false"}],"loop":"false","_standard":true}